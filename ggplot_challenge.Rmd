---
title: "ggplot challenges"
output: html_document
---

### Challenge 1

Recreate the following plot using [this dataset](http://uncg.rstats.ninja/datasets/barr_astrag_2014.txt) of astragalus measurements of antelopes 

```{r echo=F}
library(ggplot2)
theme_set(theme_bw(16))
astrag <- read.table("http://uncg.rstats.ninja/datasets/barr_astrag_2014.txt",header=T, sep="\t")

ggplot(subset(astrag, Habitat %in% c("F", "HC", "LC", "O")), aes(B,DistRad, color=Habitat)) + 
  geom_point() +
  stat_smooth(method="lm", se=F) + 
  labs(title="Astragalar Dimensions by Habitat")
```

### Challenge 2

This one requires a bit more data wrangling. 

First read in [this dataset](http://uncg.rstats.ninja/datasets/FY_2015_refugees_receiving_services.txt) on the number of refugees receiving resettlement services in all 50 states. 

Next read in this [additional dataset](http://uncg.rstats.ninja/datasets/US_state_populations.tx) on state population estimates for 2016.

Use the `merge()` function to merge the two dataframes.

Now recreate this figure below (you will first have to calculate a new `totalrefugees` column.)

```{r fig.height=7, echo=F}
refugee <- read.table("http://uncg.rstats.ninja/datasets/FY_2015_refugees_receiving_services.txt", header=T, sep=",")
pops <- read.table("http://uncg.rstats.ninja/datasets/US_state_populations.txt", header=T, sep=",")
pops$STATE <- toupper(pops$STATE)
refugee <- merge(refugee, pops)

refugee$totalrefugees <- 
  rowSums(refugee[,!names(refugee) %in% c("STATE","population_2016")])
refugee$STATE <- factor(refugee$STATE, levels=refugee$STATE[order(refugee$total/refugee$population_2016)],ordered = T)
ggplot(refugee, aes(x=totalrefugees/population_2016, y=STATE)) + 
  geom_point() +
  labs(title="number of settled refugees per capita", x="refugees per capita") +
  theme_bw(12) 
```